(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[102],{63:(e,t,a)=>{"use strict";var s=a(7260);a.o(s,"useRouter")&&a.d(t,{useRouter:function(){return s.useRouter}})},590:(e,t,a)=>{"use strict";a.d(t,{S:()=>n});let s="https://attendance-monitoring-system-g96f.onrender.com",n={BASE_URL:s,SIGNUP:"".concat(s,"/api/signup"),SIGNIN:"".concat(s,"/api/signin"),LOGOUT:"".concat(s,"/api/logout"),USER_PROFILE:"".concat(s,"/api/user/profile"),SWITCH_ROLE:"".concat(s,"/api/switch-role"),REGISTER_STUDENT:"".concat(s,"/api/register-student"),STUDENTS:"".concat(s,"/api/students"),STUDENTS_COUNT:"".concat(s,"/api/students/count"),STUDENTS_DEPARTMENTS:"".concat(s,"/api/students/departments"),STUDENTS_SEARCH:"".concat(s,"/api/students/search"),STUDENTS_STATS:"".concat(s,"/api/students/stats"),UPDATE_STUDENT:e=>"".concat(s,"/api/update-student/").concat(e),DELETE_STUDENT:e=>"".concat(s,"/api/delete-student/").concat(e),TEACHER_STUDENTS_SEARCH:"".concat(s,"/api/teacher/students/search"),TEACHER_STUDENT:e=>"".concat(s,"/api/teacher/student/").concat(e),ATTENDANCE:"".concat(s,"/api/attendance"),ATTENDANCE_EXPORT:"".concat(s,"/api/attendance/export"),ATTENDANCE_CREATE_SESSION:"".concat(s,"/api/attendance/create_session"),ATTENDANCE_ACTIVE_SESSIONS:"".concat(s,"/api/attendance/active_sessions"),ATTENDANCE_SESSION_STATUS:e=>"".concat(s,"/api/attendance/session_status/").concat(e),ATTENDANCE_END_SESSION:"".concat(s,"/api/attendance/end_session"),ATTENDANCE_REAL_MARK:"".concat(s,"/api/attendance/real-mark"),ATTENDANCE_SESSION_ATTENDANCE:e=>"".concat(s,"/api/attendance/session/").concat(e,"/attendance"),ATTENDANCE_MODELS_STATUS:"".concat(s,"/api/attendance/models/status"),DEMO_RECOGNIZE:"".concat(s,"/api/demo/recognize"),DEMO_SESSION:"".concat(s,"/api/demo/session"),DEMO_SESSION_LOG:e=>"".concat(s,"/api/demo/session/").concat(e,"/log"),DEMO_MODELS_STATUS:"".concat(s,"/api/demo/models/status"),HEALTH:"".concat(s,"/health")}},2641:(e,t,a)=>{Promise.resolve().then(a.bind(a,8134))},8134:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>d});var s=a(5155),n=a(2115),c=a(63),r=a(590);function d(){let e=(0,c.useRouter)(),[t,d]=(0,n.useState)([]),[l,i]=(0,n.useState)(!1),[o,x]=(0,n.useState)(""),[u,p]=(0,n.useState)(""),[h,m]=(0,n.useState)(""),[g,N]=(0,n.useState)(""),[b,j]=(0,n.useState)(""),[S,y]=(0,n.useState)(""),[E,v]=(0,n.useState)({totalStudents:0,presentToday:0,absentToday:0,attendanceRate:0}),[T,f]=(0,n.useState)(!1),w=async()=>{if(!o&&!u)return void alert("Please select at least one filter.");i(!0);try{let e,t=new URLSearchParams;o&&t.set("date",o),u&&t.set("department",u),h&&t.set("year",h),g&&t.set("division",g),b&&t.set("subject",b),S&&t.set("student_id",S);let a=await fetch("".concat(r.S.ATTENDANCE,"?").concat(t.toString())),s=await a.text();try{e=JSON.parse(s)}catch(e){throw console.error("Failed to parse /api/attendance response as JSON. status=",a.status,"body=",s),e}if(e&&e.success){let t=e.attendance.map((t,a)=>({_id:t.studentId||"row-".concat(a),studentId:t.studentId||t.student_id||"-",studentName:t.studentName||t.student_name||"-",date:t.date||e.date||o,time:t.markedAt||t.time||"-",status:t.status||"present",confidence:t.confidence||0}));d(t),v(e.stats)}f(!0)}catch(e){console.error("Error fetching attendance:",e)}finally{i(!1)}},_=async()=>{try{let e,t=new URLSearchParams;o&&t.set("date",o),u&&t.set("department",u),h&&t.set("year",h),g&&t.set("division",g),b&&t.set("subject",b);let s=await fetch("".concat(r.S.ATTENDANCE_EXPORT,"?").concat(t.toString())),n=await s.text();try{e=JSON.parse(n)}catch(e){throw console.error("Failed to parse /api/attendance/export response as JSON. status=",s.status,"body=",n),e}if(e&&e.success){let t=await Promise.all([a.e(524),a.e(436)]).then(a.bind(a,4246)),s=t.utils.json_to_sheet(e.data),n=t.utils.book_new();t.utils.book_append_sheet(n,s,"Attendance"),t.writeFile(n,"attendance_".concat(o||"export",".xlsx"))}}catch(e){console.error("Error exporting excel:",e)}};return(0,s.jsx)("main",{className:"min-h-screen bg-gradient-to-br from-orange-50 to-red-100 p-6",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-800",children:"Attendance Records"}),(0,s.jsx)("p",{className:"text-gray-600",children:"View and manage student attendance data"})]}),(0,s.jsx)("button",{onClick:()=>e.push("/dashboard"),className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700",children:"Back to Dashboard"})]}),(0,s.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-md mb-8",children:(0,s.jsxs)("div",{className:"flex flex-wrap gap-4 items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Date"}),(0,s.jsx)("input",{type:"date",value:o,onChange:e=>x(e.target.value),className:"border border-gray-300 px-3 py-2 rounded-lg text-gray-900 focus:ring-2 focus:ring-blue-500"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Year"}),(0,s.jsxs)("select",{value:h,onChange:e=>m(e.target.value),className:"border border-gray-300 px-3 py-2 rounded-lg text-gray-900 focus:ring-2 focus:ring-blue-500",children:[(0,s.jsx)("option",{value:"",children:"All Years"}),(0,s.jsx)("option",{value:"1st Year",children:"1st Year"}),(0,s.jsx)("option",{value:"2nd Year",children:"2nd Year"}),(0,s.jsx)("option",{value:"3rd Year",children:"3rd Year"}),(0,s.jsx)("option",{value:"4th Year",children:"4th Year"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Division"}),(0,s.jsxs)("select",{value:g,onChange:e=>N(e.target.value),className:"border border-gray-300 px-3 py-2 rounded-lg text-gray-900 focus:ring-2 focus:ring-blue-500",children:[(0,s.jsx)("option",{value:"",children:"All Divisions"}),(0,s.jsx)("option",{value:"A",children:"A"}),(0,s.jsx)("option",{value:"B",children:"B"}),(0,s.jsx)("option",{value:"C",children:"C"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject"}),(0,s.jsx)("input",{value:b,onChange:e=>j(e.target.value),placeholder:"Subject name",className:"border border-gray-300 px-3 py-2 rounded-lg text-gray-900 focus:ring-2 focus:ring-blue-500"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Student ID"}),(0,s.jsx)("input",{value:S,onChange:e=>y(e.target.value),placeholder:"Student Id",className:"border border-gray-300 px-3 py-2 rounded-lg text-gray-900 focus:ring-2 focus:ring-blue-500"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Department"}),(0,s.jsxs)("select",{value:u,onChange:e=>p(e.target.value),className:"border border-gray-300 px-3 py-2 rounded-lg text-gray-900 focus:ring-2 focus:ring-blue-500",children:[(0,s.jsx)("option",{value:"",children:"All Departments"}),(0,s.jsx)("option",{value:"Computer Science",children:"Computer Science"}),(0,s.jsx)("option",{value:"IT",children:"IT"}),(0,s.jsx)("option",{value:"Electronics",children:"Electronics"}),(0,s.jsx)("option",{value:"Mechanical",children:"Mechanical"})]})]})]}),(0,s.jsxs)("div",{className:"flex gap-4",children:[(0,s.jsx)("button",{onClick:w,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"\uD83D\uDD0D Search"}),(0,s.jsx)("button",{onClick:_,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"\uD83D\uDCD1 Export Excel"})]})]})}),t.length>0&&(0,s.jsxs)("div",{className:"grid md:grid-cols-4 gap-6 mb-8",children:[(0,s.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md text-center",children:[(0,s.jsx)("div",{className:"text-3xl font-bold text-blue-600",children:E.totalStudents}),(0,s.jsx)("div",{className:"text-sm text-gray-600",children:"Total Students"})]}),(0,s.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md text-center",children:[(0,s.jsx)("div",{className:"text-3xl font-bold text-green-600",children:E.presentToday}),(0,s.jsx)("div",{className:"text-sm text-gray-600",children:"Present Today"})]}),(0,s.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md text-center",children:[(0,s.jsx)("div",{className:"text-3xl font-bold text-red-600",children:E.absentToday}),(0,s.jsx)("div",{className:"text-sm text-gray-600",children:"Absent Today"})]}),(0,s.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md text-center",children:[(0,s.jsxs)("div",{className:"text-3xl font-bold text-purple-600",children:[E.attendanceRate,"%"]}),(0,s.jsx)("div",{className:"text-sm text-gray-600",children:"Attendance Rate"})]})]}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[(0,s.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,s.jsxs)("h3",{className:"text-lg font-semibold text-gray-800",children:["Attendance ",o?"for ".concat(new Date(o).toLocaleDateString()):""]})}),l?(0,s.jsxs)("div",{className:"p-8 text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),(0,s.jsx)("p",{children:"Loading attendance data..."})]}):T?0===t.length?(0,s.jsx)("div",{className:"p-8 text-center text-gray-500",children:"No attendance records found for the selected filters."}):(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"w-full",children:[(0,s.jsx)("thead",{className:"bg-gray-50",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student ID"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Time"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Confidence"})]})}),(0,s.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map(e=>(0,s.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.studentId}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.studentName}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(e.date).toLocaleDateString()}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.time}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsx)("span",{className:"px-2 py-1 text-xs rounded-full ".concat("present"===e.status?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:e.status})}),(0,s.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[e.confidence,"%"]})]},e._id))})]})}):(0,s.jsxs)("div",{className:"p-8 text-center text-gray-500",children:["Please apply filters and click ",(0,s.jsx)("b",{children:"Search"})," to view attendance records."]})]})]})})}}},e=>{e.O(0,[441,255,358],()=>e(e.s=2641)),_N_E=e.O()}]);