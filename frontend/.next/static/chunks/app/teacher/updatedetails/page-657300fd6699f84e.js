(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[677],{63:(e,t,a)=>{"use strict";var s=a(7260);a.o(s,"useRouter")&&a.d(t,{useRouter:function(){return s.useRouter}})},590:(e,t,a)=>{"use strict";a.d(t,{S:()=>n});let s="https://attendance-monitoring-system-g96f.onrender.com",n={BASE_URL:s,SIGNUP:"".concat(s,"/api/signup"),SIGNIN:"".concat(s,"/api/signin"),LOGOUT:"".concat(s,"/api/logout"),USER_PROFILE:"".concat(s,"/api/user/profile"),SWITCH_ROLE:"".concat(s,"/api/switch-role"),REGISTER_STUDENT:"".concat(s,"/api/register-student"),STUDENTS:"".concat(s,"/api/students"),STUDENTS_COUNT:"".concat(s,"/api/students/count"),STUDENTS_DEPARTMENTS:"".concat(s,"/api/students/departments"),STUDENTS_SEARCH:"".concat(s,"/api/students/search"),STUDENTS_STATS:"".concat(s,"/api/students/stats"),UPDATE_STUDENT:e=>"".concat(s,"/api/update-student/").concat(e),DELETE_STUDENT:e=>"".concat(s,"/api/delete-student/").concat(e),TEACHER_STUDENTS_SEARCH:"".concat(s,"/api/teacher/students/search"),TEACHER_STUDENT:e=>"".concat(s,"/api/teacher/student/").concat(e),ATTENDANCE:"".concat(s,"/api/attendance"),ATTENDANCE_EXPORT:"".concat(s,"/api/attendance/export"),ATTENDANCE_CREATE_SESSION:"".concat(s,"/api/attendance/create_session"),ATTENDANCE_ACTIVE_SESSIONS:"".concat(s,"/api/attendance/active_sessions"),ATTENDANCE_SESSION_STATUS:e=>"".concat(s,"/api/attendance/session_status/").concat(e),ATTENDANCE_END_SESSION:"".concat(s,"/api/attendance/end_session"),ATTENDANCE_REAL_MARK:"".concat(s,"/api/attendance/real-mark"),ATTENDANCE_SESSION_ATTENDANCE:e=>"".concat(s,"/api/attendance/session/").concat(e,"/attendance"),ATTENDANCE_MODELS_STATUS:"".concat(s,"/api/attendance/models/status"),DEMO_RECOGNIZE:"".concat(s,"/api/demo/recognize"),DEMO_SESSION:"".concat(s,"/api/demo/session"),DEMO_SESSION_LOG:e=>"".concat(s,"/api/demo/session/").concat(e,"/log"),DEMO_MODELS_STATUS:"".concat(s,"/api/demo/models/status"),HEALTH:"".concat(s,"/health")}},3372:(e,t,a)=>{Promise.resolve().then(a.bind(a,6537))},6537:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>d});var s=a(5155),n=a(2115),r=a(63),l=a(590);function d(){let e=(0,r.useRouter)(),[t,a]=(0,n.useState)(null),[d,i]=(0,n.useState)(null),[c,o]=(0,n.useState)([]),[u,m]=(0,n.useState)(!1),[h,g]=(0,n.useState)(!1),[x,p]=(0,n.useState)(!1),[b,N]=(0,n.useState)(""),[y,v]=(0,n.useState)(null),[S,j]=(0,n.useState)("teacher"),f=(0,n.useMemo)(()=>"teacher"===S?"/teacher/dashboard":"/dashboard",[S]),[E,D]=(0,n.useState)({studentId:"",department:"",year:"",division:"",studentName:""}),T=["Computer Science","Information Technology","Electronics","Mechanical","Civil","Electrical","Chemical","Biotechnology"],C=["1st Year","2nd Year","3rd Year","4th Year"],_=["A","B","C","D"];(0,n.useEffect)(()=>{let t=setTimeout(()=>{try{let t="true"===localStorage.getItem("isLoggedIn"),a=localStorage.getItem("userType")||"student";t&&"teacher"===a?(v(!0),j(a)):(v(!1),e.replace("/signin"))}catch(t){v(!1),e.replace("/signin")}},100);return()=>clearTimeout(t)},[e]);let w=e=>{D(t=>({...t,[e.target.name]:e.target.value}))},A=async()=>{if(!Object.values(E).some(e=>""!==e.trim()))return void N("Please enter at least one search criteria");g(!0),N(""),o([]);try{let e=new URLSearchParams;Object.entries(E).forEach(t=>{let[a,s]=t;s.trim()&&e.append(a,s.trim())});let t=await fetch("".concat(l.S.TEACHER_STUDENTS_SEARCH,"?").concat(e),{headers:{"Content-Type":"application/json","X-User-Type":"teacher","X-User-Email":localStorage.getItem("userEmail")||""}}),a=await t.json();a.success?(o(a.students),0===a.students.length?N("No students found matching your search criteria"):N("Found ".concat(a.students.length," student(s)"))):(N("❌ ".concat(a.error||"Search failed")),o([]))}catch(e){N("❌ Error connecting to server"),o([])}finally{g(!1)}},I=async e=>{m(!0),N("");try{let t=await fetch(l.S.TEACHER_STUDENT(e._id),{headers:{"Content-Type":"application/json","X-User-Type":"teacher","X-User-Email":localStorage.getItem("userEmail")||""}}),s=await t.json();s.success&&s.student?(a(s.student),i({...s.student}),N("Selected student: ".concat(s.student.studentName))):N("❌ ".concat(s.error||"Could not load student details"))}catch(e){N("❌ Error loading student details")}finally{m(!1)}},U=e=>{t&&a(t=>({...t,[e.target.name]:e.target.value}))},O=async e=>{if(e.preventDefault(),t){p(!0),N("Updating student details...");try{let e=await fetch(l.S.TEACHER_STUDENT(t._id),{method:"PUT",headers:{"Content-Type":"application/json","X-User-Type":"teacher","X-User-Email":localStorage.getItem("userEmail")||""},body:JSON.stringify({studentName:t.studentName,studentId:t.studentId,department:t.department,year:t.year,division:t.division,semester:t.semester,email:t.email,phoneNumber:t.phoneNumber})}),a=await e.json();a.success?(N("✅ Student details updated successfully!"),i({...t}),o(e=>e.map(e=>e._id===t._id?t:e))):N("❌ ".concat(a.error))}catch(e){N("❌ Error connecting to server")}finally{p(!1)}}},R=async()=>{if(t&&window.confirm("Are you sure you want to delete student ".concat(t.studentName," (ID: ").concat(t.studentId,")?\n\nThis action cannot be undone and will remove all face recognition data."))){p(!0),N("Deleting student...");try{let e=await fetch(l.S.TEACHER_STUDENT(t._id),{method:"DELETE",headers:{"Content-Type":"application/json","X-User-Type":"teacher","X-User-Email":localStorage.getItem("userEmail")||""}}),s=await e.json();s.success?(N("✅ Student ".concat(t.studentName," deleted successfully!")),a(null),i(null),o(e=>e.filter(e=>e._id!==t._id))):N("❌ ".concat(s.error))}catch(e){N("❌ Error connecting to server")}finally{p(!1)}}},k=()=>!!t&&!!d&&JSON.stringify(t)!==JSON.stringify(d);return null===y?(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Checking authorization..."})]})}):!1===y?null:(0,s.jsx)("main",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-6",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-800",children:"Update Student Details"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Search and update any student's information"})]}),(0,s.jsx)("button",{onClick:()=>e.push(f),className:"px-6 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:"Back to Dashboard"})]}),(0,s.jsxs)("div",{className:"grid lg:grid-cols-4 gap-6",children:[(0,s.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[(0,s.jsx)("h3",{className:"text-xl font-semibold text-gray-800 mb-4",children:"\uD83D\uDD0D Advanced Search"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Student ID"}),(0,s.jsx)("input",{type:"text",name:"studentId",placeholder:"e.g., STU001",value:E.studentId,onChange:w,className:"w-full border border-gray-300 px-3 py-2 rounded-lg text-gray-900 focus:ring-2 focus:ring-blue-500"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Student Name"}),(0,s.jsx)("input",{type:"text",name:"studentName",placeholder:"e.g., John Doe",value:E.studentName,onChange:w,className:"w-full border border-gray-300 px-3 py-2 rounded-lg text-gray-900 focus:ring-2 focus:ring-blue-500"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Department"}),(0,s.jsxs)("select",{name:"department",value:E.department,onChange:w,className:"w-full border border-gray-300 px-3 py-2 rounded-lg text-gray-900 focus:ring-2 focus:ring-blue-500",children:[(0,s.jsx)("option",{value:"",children:"All Departments"}),T.map(e=>(0,s.jsx)("option",{value:e,children:e},e))]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Year"}),(0,s.jsxs)("select",{name:"year",value:E.year,onChange:w,className:"w-full border border-gray-300 px-3 py-2 rounded-lg text-gray-900 focus:ring-2 focus:ring-blue-500",children:[(0,s.jsx)("option",{value:"",children:"All Years"}),C.map(e=>(0,s.jsx)("option",{value:e,children:e},e))]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Division"}),(0,s.jsxs)("select",{name:"division",value:E.division,onChange:w,className:"w-full border border-gray-300 px-3 py-2 rounded-lg text-gray-900 focus:ring-2 focus:ring-blue-500",children:[(0,s.jsx)("option",{value:"",children:"All Divisions"}),_.map(e=>(0,s.jsxs)("option",{value:e,children:["Division ",e]},e))]})]}),(0,s.jsxs)("div",{className:"space-y-2 pt-2",children:[(0,s.jsx)("button",{onClick:A,disabled:h,className:"w-full py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors",children:h?"Searching...":"\uD83D\uDD0D Search Students"}),(0,s.jsx)("button",{onClick:()=>{D({studentId:"",department:"",year:"",division:"",studentName:""}),o([]),N("")},className:"w-full py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors",children:"\uD83D\uDD04 Clear Filters"})]})]})]}),(0,s.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[(0,s.jsx)("h3",{className:"text-xl font-semibold text-gray-800 mb-4",children:"\uD83D\uDCCB Search Results"}),0===c.length?(0,s.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,s.jsx)("div",{className:"text-4xl mb-4",children:"\uD83D\uDC68‍\uD83C\uDF93"}),(0,s.jsx)("p",{className:"text-lg mb-2",children:"No students found"}),(0,s.jsx)("p",{className:"text-sm",children:"Use the search filters to find students"})]}):(0,s.jsx)("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:c.map(e=>(0,s.jsxs)("div",{className:"p-3 rounded-lg cursor-pointer transition-colors border ".concat((null==t?void 0:t._id)===e._id?"bg-blue-100 border-blue-500":"bg-gray-50 hover:bg-gray-100 border-gray-200"),onClick:()=>I(e),children:[(0,s.jsx)("div",{className:"font-medium text-gray-800",children:e.studentName}),(0,s.jsxs)("div",{className:"text-sm text-gray-600",children:["ID: ",e.studentId]}),(0,s.jsxs)("div",{className:"text-xs text-gray-500",children:[e.department," • ",e.year," • Div ",e.division]})]},e._id))})]}),(0,s.jsxs)("div",{className:"lg:col-span-2 bg-white p-6 rounded-lg shadow-md",children:[(0,s.jsx)("h3",{className:"text-xl font-semibold text-gray-800 mb-4",children:"✏️ Student Information"}),t?(0,s.jsxs)("form",{onSubmit:O,className:"space-y-6",children:[(0,s.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-semibold text-blue-800",children:"Selected Student"}),(0,s.jsx)("p",{className:"text-blue-600",children:null==d?void 0:d.studentName})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsxs)("p",{className:"text-sm text-blue-600",children:["ID: ",null==d?void 0:d.studentId]}),(0,s.jsx)("p",{className:"text-xs text-blue-500",children:(null==d?void 0:d.updated_at)?"Updated: ".concat(new Date(1e3*d.updated_at).toLocaleDateString()):"Never updated"})]})]}),k()&&(0,s.jsx)("div",{className:"mt-2 text-xs text-orange-600",children:"⚠️ You have unsaved changes"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-semibold text-gray-700 mb-3",children:"Personal Information"}),(0,s.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,s.jsx)("input",{name:"studentName",type:"text",placeholder:"Full Name",value:t.studentName,onChange:U,className:"border border-gray-300 px-3 py-2 rounded-lg text-gray-900 focus:ring-2 focus:ring-blue-500",required:!0}),(0,s.jsx)("input",{name:"studentId",type:"text",placeholder:"Student ID",value:t.studentId,onChange:U,className:"border border-gray-300 px-3 py-2 rounded-lg text-gray-900 focus:ring-2 focus:ring-blue-500",required:!0}),(0,s.jsx)("input",{name:"email",type:"email",placeholder:"Email",value:t.email,onChange:U,className:"border border-gray-300 px-3 py-2 rounded-lg text-gray-900 focus:ring-2 focus:ring-blue-500",required:!0}),(0,s.jsx)("input",{name:"phoneNumber",type:"tel",placeholder:"Phone Number",value:t.phoneNumber,onChange:U,className:"border border-gray-300 px-3 py-2 rounded-lg text-gray-900 focus:ring-2 focus:ring-blue-500",required:!0})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-semibold text-gray-700 mb-3",children:"Academic Information"}),(0,s.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,s.jsx)("select",{name:"department",value:t.department,onChange:U,className:"border border-gray-300 px-3 py-2 rounded-lg text-gray-900 focus:ring-2 focus:ring-blue-500",required:!0,children:T.map(e=>(0,s.jsx)("option",{value:e,children:e},e))}),(0,s.jsx)("select",{name:"year",value:t.year,onChange:U,className:"border border-gray-300 px-3 py-2 rounded-lg text-gray-900 focus:ring-2 focus:ring-blue-500",required:!0,children:C.map(e=>(0,s.jsx)("option",{value:e,children:e},e))}),(0,s.jsx)("select",{name:"division",value:t.division,onChange:U,className:"border border-gray-300 px-3 py-2 rounded-lg text-gray-900 focus:ring-2 focus:ring-blue-500",required:!0,children:_.map(e=>(0,s.jsxs)("option",{value:e,children:["Division ",e]},e))}),(0,s.jsx)("select",{name:"semester",value:t.semester,onChange:U,className:"border border-gray-300 px-3 py-2 rounded-lg text-gray-900 focus:ring-2 focus:ring-blue-500",required:!0,children:["1","2","3","4","5","6","7","8"].map(e=>(0,s.jsxs)("option",{value:e,children:["Semester ",e]},e))})]})]}),(0,s.jsxs)("div",{className:"flex gap-4 pt-4",children:[(0,s.jsx)("button",{type:"submit",disabled:x||!k(),className:"flex-1 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed font-medium",children:x?"Updating...":"\uD83D\uDCBE Save Changes"}),(0,s.jsx)("button",{type:"button",onClick:()=>{d&&(a({...d}),N(""))},disabled:!k(),className:"px-6 py-3 bg-gray-500 text-white rounded-lg hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed",children:"\uD83D\uDD04 Reset"}),(0,s.jsx)("button",{type:"button",onClick:R,disabled:x,className:"px-6 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"\uD83D\uDDD1️ Delete"})]})]}):(0,s.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,s.jsx)("div",{className:"text-6xl mb-4",children:"\uD83D\uDC68‍\uD83C\uDF93"}),(0,s.jsx)("p",{className:"text-lg mb-2",children:"No student selected"}),(0,s.jsx)("p",{className:"text-sm",children:"Search for and select a student to view and edit their details"})]})]})]}),b&&(0,s.jsx)("div",{className:"mt-6 p-4 rounded-lg text-center max-w-2xl mx-auto ".concat(b.includes("✅")?"bg-green-100 text-green-800 border border-green-200":"bg-red-100 text-red-800 border border-red-200"),children:b}),(0,s.jsxs)("div",{className:"mt-8 bg-yellow-50 border border-yellow-200 p-4 rounded-lg max-w-4xl mx-auto",children:[(0,s.jsx)("h4",{className:"font-semibold text-yellow-800 mb-2",children:"\uD83D\uDCCB Instructions"}),(0,s.jsxs)("ul",{className:"text-sm text-yellow-700 space-y-1",children:[(0,s.jsx)("li",{children:"• Use the advanced search filters to find students by ID, name, department, year, or division"}),(0,s.jsx)("li",{children:"• Click on a student from the search results to select and view their details"}),(0,s.jsx)("li",{children:'• Edit any field in the student information form and click "Save Changes"'}),(0,s.jsx)("li",{children:'• Use "Reset" to undo unsaved changes'}),(0,s.jsx)("li",{children:'• Be careful with the "Delete" option - it cannot be undone'})]})]})]})})}}},e=>{e.O(0,[441,255,358],()=>e(e.s=3372)),_N_E=e.O()}]);